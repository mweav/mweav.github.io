<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Higher Types — Categories with Families...in Agda!</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/agda.css" />

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-74182143-1', 'auto');
	  ga('send', 'pageview');

        </script>

    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../index.html">Higher Types</a>
            </div>
            <div id="navigation">
                <a href="../index.html">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Categories with Families...in Agda!</h1>

            <div class="post">
    Posted on February  9, 2016
    
      
        by <a href="mailto:mweav@sas.upenn.edu">Matthew Weaver</a>
      
    
</div>

<p>Here is a definition of categories with families I implemented in Agda. I wrote this using a neat category theory library.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> A category with families (CwF) is a categorical model of dependent type theory introduced by Peter Dybjer.<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> Recently, they’ve been used with much success to model type theories with higher dimensional structures, such as higher dimensional equality,<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a> an internalized computational interpretation of parametricity,<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a> and a primative notion of names.<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a></p>
<!--more-->
<p>First, lets jump over the boring imports.</p>
<pre class="Agda"><code><a name="1641"></a><a name="1656" class="Keyword">module</a><a name="1662"> </a><a name="1663" href="#1" class="Module">CwF</a><a name="1666"> </a><a name="1667" class="Keyword">where</a><a name="1672">

</a><a name="1674" class="Keyword">open</a><a name="1678"> </a><a name="1679" class="Keyword">import</a><a name="1685"> </a><a name="1686" class="Module">prelude</a><a name="1693">
</a><a name="1694" class="Keyword">open</a><a name="1698"> </a><a name="1699" class="Keyword">import</a><a name="1705"> </a><a name="1706" class="Module">Level</a><a name="1711">
</a><a name="1712" class="Keyword">open</a><a name="1716"> </a><a name="1717" class="Keyword">import</a><a name="1723"> </a><a name="1724" class="Module">Categories.Category</a><a name="1743">
</a><a name="1744" class="Keyword">open</a><a name="1748"> </a><a name="1749" class="Keyword">import</a><a name="1755"> </a><a name="1756" class="Module">Categories.Functor</a><a name="1774"> </a><a name="1775" class="Keyword">renaming</a><a name="1783"> </a><a name="1784" class="Symbol">(</a><a name="1785">_≡_ </a><a name="1789" class="Symbol">to</a><a name="1791"> _==_</a><a name="1796" class="Symbol">;</a><a name="1797"> _∘_ </a><a name="1802" class="Symbol">to</a><a name="1804"> comp</a><a name="1809" class="Symbol">)</a><a name="1810">
</a><a name="1811" class="Keyword">open</a><a name="1815"> </a><a name="1816" class="Keyword">import</a><a name="1822"> </a><a name="1823" class="Module">Categories.Fam</a><a name="1837"> 
</a><a name="1839" class="Keyword">open</a><a name="1843"> </a><a name="1844" class="Keyword">import</a><a name="1850"> </a><a name="1851" class="Module">Categories.Presheaf</a><a name="1870">
</a><a name="1871" class="Keyword">open</a><a name="1875"> </a><a name="1876" class="Keyword">import</a><a name="1882"> </a><a name="1883" class="Module">Categories.Support.PropositionalEquality</a><a name="1923">

</a><a name="1925" class="Keyword">import</a><a name="1931"> </a><a name="1932" class="Module">Categories.Object.Terminal</a><a name="1958"> </a><a name="1959" class="Symbol">as</a><a name="1961"> </a><a name="1962" class="Module">Terminal</a></code></pre>
<p>As shown here in the type signature of <code>CwF</code>, a Category with Families is given by a category <code>C</code> and a functor <code>F: C</code><span class="math inline"><em></em><sup><em>o</em><em>p</em></sup></span> → <code>Fam</code>, where <code>Fam</code> is the category of families of sets. An equivalent way of describing <code>F</code> is as a <code>Fam</code> indexed presheaf over <code>C</code> (and hence the type of <code>F</code> is defined below as a <code>Presheaf</code> and not a <code>Functor</code>).</p>
<pre class="Agda"><code><a name="2324"></a><a name="2339" class="Keyword">record</a><a name="2345"> </a><a name="2346" href="#2346" class="Record">CwF</a><a name="2349"> </a><a name="2350" class="Symbol">{</a><a name="2351" href="#2351" class="Bound">o</a><a name="2352"> </a><a name="2353" href="#2353" class="Bound">ℓ</a><a name="2354"> </a><a name="2355" href="#2355" class="Bound">e</a><a name="2356"> </a><a name="2357" href="#2357" class="Bound">a</a><a name="2358"> </a><a name="2359" href="#2359" class="Bound">b</a><a name="2360"> </a><a name="2361" class="Symbol">:</a><a name="2362"> </a><a name="2363" class="Postulate">Level</a><a name="2368" class="Symbol">}</a><a name="2369">
           </a><a name="2381" class="Symbol">(</a><a name="2382" href="#2382" class="Bound">C</a><a name="2383"> </a><a name="2384" class="Symbol">:</a><a name="2385"> </a><a name="2386" class="Record">Category</a><a name="2394"> </a><a name="2395" href="#2351" class="Bound">o</a><a name="2396"> </a><a name="2397" href="#2353" class="Bound">ℓ</a><a name="2398"> </a><a name="2399" href="#2355" class="Bound">e</a><a name="2400" class="Symbol">)</a><a name="2401">
           </a><a name="2413" class="Symbol">(</a><a name="2414" href="#2414" class="Bound">F</a><a name="2415"> </a><a name="2416" class="Symbol">:</a><a name="2417"> </a><a name="2418" class="Function">Presheaf</a><a name="2426"> </a><a name="2427" href="#2382" class="Bound">C</a><a name="2428"> </a><a name="2429" class="Symbol">(</a><a name="2430" class="Function">Fam</a><a name="2433"> </a><a name="2434" href="#2357" class="Bound">a</a><a name="2435"> </a><a name="2436" href="#2359" class="Bound">b</a><a name="2437" class="Symbol">))</a><a name="2439">
           </a><a name="2451" class="Symbol">:</a><a name="2452"> </a><a name="2453" class="PrimitiveType">Set</a><a name="2456"> </a><a name="2457" class="Symbol">(</a><a name="2458" class="Primitive">suc</a><a name="2461"> </a><a name="2462" class="Symbol">(</a><a name="2463" href="#2351" class="Bound">o</a><a name="2464"> </a><a name="2465" class="Primitive Operator">⊔</a><a name="2466"> </a><a name="2467" href="#2353" class="Bound">ℓ</a><a name="2468"> </a><a name="2469" class="Primitive Operator">⊔</a><a name="2470"> </a><a name="2471" href="#2355" class="Bound">e</a><a name="2472"> </a><a name="2473" class="Primitive Operator">⊔</a><a name="2474"> </a><a name="2475" href="#2357" class="Bound">a</a><a name="2476"> </a><a name="2477" class="Primitive Operator">⊔</a><a name="2478"> </a><a name="2479" href="#2359" class="Bound">b</a><a name="2480" class="Symbol">))</a><a name="2482"> </a><a name="2483" class="Keyword">where</a><a name="2488">

  </a><a name="2492" class="Keyword">open</a><a name="2496"> </a><a name="2497" class="Module">Category</a><a name="2505"> </a><a name="2506" href="#2382" class="Bound">C</a><a name="2507"> </a><a name="2508" class="Keyword">renaming</a><a name="2516"> </a><a name="2517" class="Symbol">(</a><a name="2518">_≡_ </a><a name="2522" class="Symbol">to</a><a name="2524"> _≅_</a><a name="2528" class="Symbol">)</a><a name="2529">
  </a><a name="2532" class="Keyword">open</a><a name="2536"> </a><a name="2537" class="Module">Terminal</a><a name="2545"> </a><a name="2546" href="#2382" class="Bound">C</a><a name="2547">
  </a><a name="2550" class="Keyword">open</a><a name="2554"> </a><a name="2555" class="Module">Functor</a><a name="2562"> </a><a name="2563" href="#2414" class="Bound">F</a><a name="2564">
  </a><a name="2567" class="Keyword">open</a><a name="2571"> </a><a name="2572" class="Module">Fam</a><a name="2575"> </a><a name="2576" class="Keyword">renaming</a><a name="2584"> </a><a name="2585" class="Symbol">(</a><a name="2586">_≡_ </a><a name="2590" class="Symbol">to</a><a name="2592"> _==_</a><a name="2597" class="Symbol">;</a><a name="2598"> _∘_ </a><a name="2603" class="Symbol">to</a><a name="2605"> comp</a><a name="2610" class="Symbol">)</a><a name="2611">

  </a><a name="2615" class="Keyword">module</a><a name="2621"> </a><a name="2622" href="#2622" class="Module">C</a><a name="2623"> </a><a name="2624" class="Symbol">=</a><a name="2625"> </a><a name="2626" class="Module">Category</a><a name="2634"> </a><a name="2635" href="#2382" class="Bound">C</a><a name="2636">
  </a><a name="2639" class="Keyword">module</a><a name="2645"> </a><a name="2646" href="#2646" class="Module">F</a><a name="2647"> </a><a name="2648" class="Symbol">=</a><a name="2649"> </a><a name="2650" class="Module">Functor</a><a name="2657"> </a><a name="2658" href="#2414" class="Bound">F</a></code></pre>
<p>Given this basic categorical structure, we can now describe the interpretations for the various elements of a type system. The objects of the base category, <code>C</code>, will denote all of the contexts for the typing judgement. As such, we use <code>Ctx</code> to refer to the set of objects of <code>C</code> in our code.</p>
<pre class="Agda"><code><a name="2964">  </a><a name="2981" href="#2981" class="Bound">Ctx</a><a name="2984"> </a><a name="2985" class="Symbol">=</a><a name="2986"> </a><a name="2987" class="Function">C.Obj</a></code></pre>
<p>Thus, the morphisms of <code>C</code> are context substitutions. The set of all morphisms from <code>Δ</code> to <code>Γ</code> is written as <code>Subst Δ Γ</code> in Agda.</p>
<pre class="Agda"><code><a name="3134">  </a><a name="3151" href="#3151" class="Bound">Subst</a><a name="3156"> </a><a name="3157" class="Symbol">=</a><a name="3158"> </a><a name="3159" class="Function Operator">C._⇒_</a><a name="3164">


  </a><a name="3169" href="#3169" class="Bound">Id</a><a name="3171"> </a><a name="3172" class="Symbol">:</a><a name="3173"> </a><a name="3174" class="Symbol">{</a><a name="3175" href="#3175" class="Bound">Γ</a><a name="3176"> </a><a name="3177" class="Symbol">:</a><a name="3178"> </a><a name="3179" href="#2981" class="Bound">Ctx</a><a name="3182" class="Symbol">}</a><a name="3183"> </a><a name="3184" class="Symbol">→</a><a name="3185"> </a><a name="3186" href="#3151" class="Bound">Subst</a><a name="3191"> </a><a name="3192" href="#3175" class="Bound">Γ</a><a name="3193"> </a><a name="3194" href="#3175" class="Bound">Γ</a><a name="3195">
  </a><a name="3198" href="#3169" class="Function">Id</a><a name="3200"> </a><a name="3201" class="Symbol">=</a><a name="3202"> </a><a name="3203" class="Function">C.id</a></code></pre>
<p>Whenever we apply the functor <code>F</code> to some object of <code>C</code>, say <code>Γ</code>, the resulting object is a family of sets: <code>F(Γ) = (T, (B[A])</code><span class="math inline"><em></em><sub><em>A</em> ∈ <em>T</em></sub></span><code>)</code>. The set <code>T</code> represents the set of all types valid under context <code>Γ</code>, and the set <code>B[A]</code> contains all terms of type <code>A</code> valid under <code>Γ</code>. In Agda, we write <code>Ty Γ</code> for the set of types under <code>Γ</code>, and <code>Ter Γ A</code> for the terms of type <code>A</code> under <code>Γ</code>.</p>
<pre class="Agda"><code><a name="3605">  </a><a name="3622" href="#3622" class="Bound">Ty</a><a name="3624"> </a><a name="3625" class="Symbol">:</a><a name="3626"> </a><a name="3627" href="#2981" class="Bound">Ctx</a><a name="3630"> </a><a name="3631" class="Symbol">→</a><a name="3632"> </a><a name="3633" class="PrimitiveType">Set</a><a name="3636"> </a><a name="3637" class="Symbol">_</a><a name="3638">
  </a><a name="3641" href="#3622" class="Function">Ty</a><a name="3643"> </a><a name="3644" href="#3644" class="Bound">Γ</a><a name="3645"> </a><a name="3646" class="Symbol">=</a><a name="3647"> </a><a name="3648" class="Field">U</a><a name="3649"> </a><a name="3650" class="Symbol">(</a><a name="3651" class="Field">F.F₀</a><a name="3655"> </a><a name="3656" href="#3644" class="Bound">Γ</a><a name="3657" class="Symbol">)</a><a name="3658">


  </a><a name="3663" href="#3663" class="Bound">Ter</a><a name="3666"> </a><a name="3667" class="Symbol">:</a><a name="3668"> </a><a name="3669" class="Symbol">(</a><a name="3670" href="#3670" class="Bound">Γ</a><a name="3671"> </a><a name="3672" class="Symbol">:</a><a name="3673"> </a><a name="3674" href="#2981" class="Bound">Ctx</a><a name="3677" class="Symbol">)</a><a name="3678"> </a><a name="3679" class="Symbol">→</a><a name="3680"> </a><a name="3681" href="#3622" class="Bound">Ty</a><a name="3683"> </a><a name="3684" href="#3670" class="Bound">Γ</a><a name="3685"> </a><a name="3686" class="Symbol">→</a><a name="3687"> </a><a name="3688" class="PrimitiveType">Set</a><a name="3691"> </a><a name="3692" class="Symbol">_</a><a name="3693">
  </a><a name="3696" href="#3663" class="Function">Ter</a><a name="3699"> </a><a name="3700" href="#3700" class="Bound">Γ</a><a name="3701"> </a><a name="3702" href="#3702" class="Bound">A</a><a name="3703"> </a><a name="3704" class="Symbol">=</a><a name="3705"> </a><a name="3706" class="Symbol">(</a><a name="3707" class="Field">T</a><a name="3708"> </a><a name="3709" class="Symbol">(</a><a name="3710" class="Field">F.F₀</a><a name="3714"> </a><a name="3715" href="#3700" class="Bound">Γ</a><a name="3716" class="Symbol">))</a><a name="3718"> </a><a name="3719" href="#3702" class="Bound">A</a></code></pre>
<p>To make our syntax in Agda lighter, we define two operators, <code>TApp</code> and <code>tApp</code> that correspond to applying the action of a context substition through the functor <code>F</code> to types and terms, respectively. Note that, as the functor <code>F</code> goes from <code>C</code><span class="math inline"><em></em><sup><em>o</em><em>p</em></sup></span> into <code>Fam</code>, it is contravariant in <code>C</code> and thus the morphism <code>σ</code> goes from <code>Δ</code> to <code>Γ</code> so that the action of the substition on types and terms goes from <code>Γ</code> to <code>Δ</code>.</p>
<pre class="Agda"><code><a name="4149">  </a><a name="4166" href="#4166" class="Bound">TApp</a><a name="4170"> </a><a name="4171" class="Symbol">:</a><a name="4172"> </a><a name="4173" class="Symbol">{</a><a name="4174" href="#4174" class="Bound">Δ</a><a name="4175"> </a><a name="4176" href="#4176" class="Bound">Γ</a><a name="4177"> </a><a name="4178" class="Symbol">:</a><a name="4179"> </a><a name="4180" href="#2981" class="Bound">Ctx</a><a name="4183" class="Symbol">}</a><a name="4184">
         </a><a name="4194" class="Symbol">(</a><a name="4195" href="#4195" class="Bound">σ</a><a name="4196">   </a><a name="4199" class="Symbol">:</a><a name="4200"> </a><a name="4201" href="#3151" class="Bound">Subst</a><a name="4206"> </a><a name="4207" href="#4174" class="Bound">Δ</a><a name="4208"> </a><a name="4209" href="#4176" class="Bound">Γ</a><a name="4210" class="Symbol">)</a><a name="4211">
         </a><a name="4221" class="Symbol">(</a><a name="4222" href="#4222" class="Bound">A</a><a name="4223">   </a><a name="4226" class="Symbol">:</a><a name="4227"> </a><a name="4228" href="#3622" class="Bound">Ty</a><a name="4230"> </a><a name="4231" href="#4176" class="Bound">Γ</a><a name="4232" class="Symbol">)</a><a name="4233">
         </a><a name="4243" class="Symbol">→</a><a name="4244"> </a><a name="4245" class="Comment">---------------</a><a name="4260">
         </a><a name="4270" href="#3622" class="Bound">Ty</a><a name="4272"> </a><a name="4273" href="#4174" class="Bound">Δ</a><a name="4274">
         
  </a><a name="4287" href="#4166" class="Function">TApp</a><a name="4291"> </a><a name="4292" href="#4292" class="Bound">σ</a><a name="4293"> </a><a name="4294" href="#4294" class="Bound">A</a><a name="4295"> </a><a name="4296" class="Symbol">=</a><a name="4297"> </a><a name="4298" class="Symbol">(</a><a name="4299" class="Field">Hom.f</a><a name="4304"> </a><a name="4305" class="Symbol">(</a><a name="4306" class="Field">F.F₁</a><a name="4310"> </a><a name="4311" href="#4292" class="Bound">σ</a><a name="4312" class="Symbol">))</a><a name="4314"> </a><a name="4315" href="#4294" class="Bound">A</a><a name="4316">


  </a><a name="4321" href="#4321" class="Bound">tApp</a><a name="4325"> </a><a name="4326" class="Symbol">:</a><a name="4327"> </a><a name="4328" class="Symbol">{</a><a name="4329" href="#4329" class="Bound">Δ</a><a name="4330"> </a><a name="4331" href="#4331" class="Bound">Γ</a><a name="4332"> </a><a name="4333" class="Symbol">:</a><a name="4334"> </a><a name="4335" href="#2981" class="Bound">Ctx</a><a name="4338" class="Symbol">}</a><a name="4339">
         </a><a name="4349" class="Symbol">(</a><a name="4350" href="#4350" class="Bound">σ</a><a name="4351">   </a><a name="4354" class="Symbol">:</a><a name="4355"> </a><a name="4356" href="#3151" class="Bound">Subst</a><a name="4361"> </a><a name="4362" href="#4329" class="Bound">Δ</a><a name="4363"> </a><a name="4364" href="#4331" class="Bound">Γ</a><a name="4365" class="Symbol">)</a><a name="4366">
         </a><a name="4376" class="Symbol">{</a><a name="4377" href="#4377" class="Bound">A</a><a name="4378">   </a><a name="4381" class="Symbol">:</a><a name="4382"> </a><a name="4383" href="#3622" class="Bound">Ty</a><a name="4385"> </a><a name="4386" href="#4331" class="Bound">Γ</a><a name="4387" class="Symbol">}</a><a name="4388">
         </a><a name="4398" class="Symbol">(</a><a name="4399" href="#4399" class="Bound">a</a><a name="4400">   </a><a name="4403" class="Symbol">:</a><a name="4404"> </a><a name="4405" href="#3663" class="Bound">Ter</a><a name="4408"> </a><a name="4409" href="#4331" class="Bound">Γ</a><a name="4410"> </a><a name="4411" href="#4377" class="Bound">A</a><a name="4412" class="Symbol">)</a><a name="4413">
         </a><a name="4423" class="Symbol">→</a><a name="4424"> </a><a name="4425" class="Comment">---------------</a><a name="4440">
         </a><a name="4450" href="#3663" class="Bound">Ter</a><a name="4453"> </a><a name="4454" href="#4329" class="Bound">Δ</a><a name="4455"> </a><a name="4456" class="Symbol">(</a><a name="4457" href="#4166" class="Bound">TApp</a><a name="4461"> </a><a name="4462" href="#4350" class="Bound">σ</a><a name="4463"> </a><a name="4464" href="#4377" class="Bound">A</a><a name="4465" class="Symbol">)</a><a name="4466">
         
  </a><a name="4479" href="#4321" class="Function">tApp</a><a name="4483"> </a><a name="4484" href="#4484" class="Bound">σ</a><a name="4485"> </a><a name="4486" class="Symbol">{</a><a name="4487" href="#4487" class="Bound">A</a><a name="4488" class="Symbol">}</a><a name="4489"> </a><a name="4490" href="#4490" class="Bound">a</a><a name="4491"> </a><a name="4492" class="Symbol">=</a><a name="4493"> </a><a name="4494" class="Symbol">(</a><a name="4495" class="Field">Hom.φ</a><a name="4500"> </a><a name="4501" class="Symbol">(</a><a name="4502" class="Field">F.F₁</a><a name="4506"> </a><a name="4507" href="#4484" class="Bound">σ</a><a name="4508" class="Symbol">))</a><a name="4510"> </a><a name="4511" href="#4487" class="Bound">A</a><a name="4512"> </a><a name="4513" href="#4490" class="Bound">a</a></code></pre>
<p>We first require the following equalities on our interpretation of types and terms. These all should actually be derivable from the categories library I’m using, but I have not yet taken the time to actually do so.</p>
<p>To explain a bit of the syntax and mechanics used to manipulate equality in the code that follows, <code>_≡_</code> is propositional equality, while <code>_≅_</code> is the equality of morphisms in a category. <code>ap</code> is the operation that pushes an equality through a function, as equality is applicative. The syntax <code>_≡[_]≡_</code> is heterogeneous equality where the middle term is a proof of equality between the types of the terms on either side. Lastly, <code>coe</code> coerces a term from one type to another given a proof the two types are equal.</p>
<pre class="Agda"><code><a name="5256">  </a><a name="5273" class="Keyword">field</a><a name="5278"> 
    </a><a name="5284" href="#5284" class="Field">TIdEq</a><a name="5289">     </a><a name="5294" class="Symbol">:</a><a name="5295"> </a><a name="5296" class="Symbol">{</a><a name="5297" href="#5297" class="Bound">Γ</a><a name="5298">     </a><a name="5303" class="Symbol">:</a><a name="5304"> </a><a name="5305" href="#2981" class="Bound">Ctx</a><a name="5308" class="Symbol">}</a><a name="5309">
                </a><a name="5326" class="Symbol">{</a><a name="5327" href="#5327" class="Bound">A</a><a name="5328">     </a><a name="5333" class="Symbol">:</a><a name="5334"> </a><a name="5335" href="#3622" class="Bound">Ty</a><a name="5337"> </a><a name="5338" href="#5297" class="Bound">Γ</a><a name="5339" class="Symbol">}</a><a name="5340">
                </a><a name="5357" class="Symbol">→</a><a name="5358"> </a><a name="5359" class="Comment">---------------------------------------------------</a><a name="5410">
                </a><a name="5427" href="#4166" class="Bound">TApp</a><a name="5431"> </a><a name="5432" href="#3169" class="Bound">Id</a><a name="5434"> </a><a name="5435" href="#5327" class="Bound">A</a><a name="5436"> </a><a name="5437" class="Datatype Operator">≡</a><a name="5438"> </a><a name="5439" href="#5327" class="Bound">A</a><a name="5440">

    </a><a name="5446" href="#5446" class="Field">TAppEq</a><a name="5452">    </a><a name="5456" class="Symbol">:</a><a name="5457"> </a><a name="5458" class="Symbol">{</a><a name="5459" href="#5459" class="Bound">Δ</a><a name="5460"> </a><a name="5461" href="#5461" class="Bound">Γ</a><a name="5462"> </a><a name="5463" href="#5463" class="Bound">Θ</a><a name="5464"> </a><a name="5465" class="Symbol">:</a><a name="5466"> </a><a name="5467" href="#2981" class="Bound">Ctx</a><a name="5470" class="Symbol">}</a><a name="5471">
                </a><a name="5488" class="Symbol">{</a><a name="5489" href="#5489" class="Bound">σ</a><a name="5490">     </a><a name="5495" class="Symbol">:</a><a name="5496"> </a><a name="5497" href="#3151" class="Bound">Subst</a><a name="5502"> </a><a name="5503" href="#5459" class="Bound">Δ</a><a name="5504"> </a><a name="5505" href="#5461" class="Bound">Γ</a><a name="5506" class="Symbol">}</a><a name="5507">               
                </a><a name="5539" class="Symbol">{</a><a name="5540" href="#5540" class="Bound">τ</a><a name="5541">     </a><a name="5546" class="Symbol">:</a><a name="5547"> </a><a name="5548" href="#3151" class="Bound">Subst</a><a name="5553"> </a><a name="5554" href="#5463" class="Bound">Θ</a><a name="5555"> </a><a name="5556" href="#5459" class="Bound">Δ</a><a name="5557" class="Symbol">}</a><a name="5558">
                </a><a name="5575" class="Symbol">{</a><a name="5576" href="#5576" class="Bound">A</a><a name="5577">     </a><a name="5582" class="Symbol">:</a><a name="5583"> </a><a name="5584" href="#3622" class="Bound">Ty</a><a name="5586"> </a><a name="5587" href="#5461" class="Bound">Γ</a><a name="5588" class="Symbol">}</a><a name="5589">
                </a><a name="5606" class="Symbol">→</a><a name="5607"> </a><a name="5608" class="Comment">---------------------------------------------------</a><a name="5659">
                </a><a name="5676" href="#4166" class="Bound">TApp</a><a name="5680"> </a><a name="5681" href="#5540" class="Bound">τ</a><a name="5682"> </a><a name="5683" class="Symbol">(</a><a name="5684" href="#4166" class="Bound">TApp</a><a name="5688"> </a><a name="5689" href="#5489" class="Bound">σ</a><a name="5690"> </a><a name="5691" href="#5576" class="Bound">A</a><a name="5692" class="Symbol">)</a><a name="5693"> </a><a name="5694" class="Datatype Operator">≡</a><a name="5695"> </a><a name="5696" href="#4166" class="Bound">TApp</a><a name="5700"> </a><a name="5701" class="Symbol">(</a><a name="5702" href="#5489" class="Bound">σ</a><a name="5703"> </a><a name="5704" class="Function Operator">∘</a><a name="5705"> </a><a name="5706" href="#5540" class="Bound">τ</a><a name="5707" class="Symbol">)</a><a name="5708"> </a><a name="5709" href="#5576" class="Bound">A</a><a name="5710">

    </a><a name="5716" href="#5716" class="Field">TAppAp</a><a name="5722">    </a><a name="5726" class="Symbol">:</a><a name="5727"> </a><a name="5728" class="Symbol">{</a><a name="5729" href="#5729" class="Bound">Δ</a><a name="5730"> </a><a name="5731" href="#5731" class="Bound">Γ</a><a name="5732">   </a><a name="5735" class="Symbol">:</a><a name="5736"> </a><a name="5737" href="#2981" class="Bound">Ctx</a><a name="5740" class="Symbol">}</a><a name="5741">
                </a><a name="5758" class="Symbol">{</a><a name="5759" href="#5759" class="Bound">σ</a><a name="5760">     </a><a name="5765" class="Symbol">:</a><a name="5766"> </a><a name="5767" href="#3151" class="Bound">Subst</a><a name="5772"> </a><a name="5773" href="#5729" class="Bound">Δ</a><a name="5774"> </a><a name="5775" href="#5731" class="Bound">Γ</a><a name="5776" class="Symbol">}</a><a name="5777">               
                </a><a name="5809" class="Symbol">{</a><a name="5810" href="#5810" class="Bound">τ</a><a name="5811">     </a><a name="5816" class="Symbol">:</a><a name="5817"> </a><a name="5818" href="#3151" class="Bound">Subst</a><a name="5823"> </a><a name="5824" href="#5729" class="Bound">Δ</a><a name="5825"> </a><a name="5826" href="#5731" class="Bound">Γ</a><a name="5827" class="Symbol">}</a><a name="5828">
                </a><a name="5845" class="Symbol">{</a><a name="5846" href="#5846" class="Bound">A</a><a name="5847">     </a><a name="5852" class="Symbol">:</a><a name="5853"> </a><a name="5854" href="#3622" class="Bound">Ty</a><a name="5856"> </a><a name="5857" href="#5731" class="Bound">Γ</a><a name="5858" class="Symbol">}</a><a name="5859">
                </a><a name="5876" class="Symbol">(</a><a name="5877" href="#5877" class="Bound">p</a><a name="5878">     </a><a name="5883" class="Symbol">:</a><a name="5884"> </a><a name="5885" href="#5759" class="Bound">σ</a><a name="5886"> </a><a name="5887" class="Function Operator">≅</a><a name="5888"> </a><a name="5889" href="#5810" class="Bound">τ</a><a name="5890" class="Symbol">)</a><a name="5891">
                </a><a name="5908" class="Symbol">→</a><a name="5909"> </a><a name="5910" class="Comment">---------------------------------------------------</a><a name="5961">
                </a><a name="5978" href="#4166" class="Bound">TApp</a><a name="5982"> </a><a name="5983" href="#5759" class="Bound">σ</a><a name="5984"> </a><a name="5985" href="#5846" class="Bound">A</a><a name="5986"> </a><a name="5987" class="Datatype Operator">≡</a><a name="5988"> </a><a name="5989" href="#4166" class="Bound">TApp</a><a name="5993"> </a><a name="5994" href="#5810" class="Bound">τ</a><a name="5995"> </a><a name="5996" href="#5846" class="Bound">A</a><a name="5997">

    </a><a name="6003" href="#6003" class="Field">tIdEq</a><a name="6008">     </a><a name="6013" class="Symbol">:</a><a name="6014"> </a><a name="6015" class="Symbol">{</a><a name="6016" href="#6016" class="Bound">Γ</a><a name="6017">     </a><a name="6022" class="Symbol">:</a><a name="6023"> </a><a name="6024" href="#2981" class="Bound">Ctx</a><a name="6027" class="Symbol">}</a><a name="6028">
                </a><a name="6045" class="Symbol">{</a><a name="6046" href="#6046" class="Bound">A</a><a name="6047">     </a><a name="6052" class="Symbol">:</a><a name="6053"> </a><a name="6054" href="#3622" class="Bound">Ty</a><a name="6056"> </a><a name="6057" href="#6016" class="Bound">Γ</a><a name="6058" class="Symbol">}</a><a name="6059">
                </a><a name="6076" class="Symbol">{</a><a name="6077" href="#6077" class="Bound">a</a><a name="6078">     </a><a name="6083" class="Symbol">:</a><a name="6084"> </a><a name="6085" href="#3663" class="Bound">Ter</a><a name="6088"> </a><a name="6089" href="#6016" class="Bound">Γ</a><a name="6090"> </a><a name="6091" href="#6046" class="Bound">A</a><a name="6092" class="Symbol">}</a><a name="6093">
                </a><a name="6110" class="Symbol">→</a><a name="6111"> </a><a name="6112" class="Comment">---------------------------------------------------</a><a name="6163">
                </a><a name="6180" href="#4321" class="Bound">tApp</a><a name="6184"> </a><a name="6185" href="#3169" class="Bound">Id</a><a name="6187"> </a><a name="6188" href="#6077" class="Bound">a</a><a name="6189">
                  </a><a name="6208" class="Function Operator">≡[</a><a name="6210"> </a><a name="6211" class="Function">ap</a><a name="6213"> </a><a name="6214" class="Symbol">(</a><a name="6215" href="#3663" class="Bound">Ter</a><a name="6218"> </a><a name="6219" href="#6016" class="Bound">Γ</a><a name="6220" class="Symbol">)</a><a name="6221"> </a><a name="6222" href="#5284" class="Bound">TIdEq</a><a name="6227"> </a><a name="6228" class="Function Operator">]≡</a><a name="6230">
                </a><a name="6247" href="#6077" class="Bound">a</a><a name="6248">

    </a><a name="6254" href="#6254" class="Field">tAppEq</a><a name="6260">    </a><a name="6264" class="Symbol">:</a><a name="6265"> </a><a name="6266" class="Symbol">{</a><a name="6267" href="#6267" class="Bound">Θ</a><a name="6268"> </a><a name="6269" href="#6269" class="Bound">Δ</a><a name="6270"> </a><a name="6271" href="#6271" class="Bound">Γ</a><a name="6272"> </a><a name="6273" class="Symbol">:</a><a name="6274"> </a><a name="6275" href="#2981" class="Bound">Ctx</a><a name="6278" class="Symbol">}</a><a name="6279">
                </a><a name="6296" class="Symbol">{</a><a name="6297" href="#6297" class="Bound">σ</a><a name="6298">     </a><a name="6303" class="Symbol">:</a><a name="6304"> </a><a name="6305" href="#3151" class="Bound">Subst</a><a name="6310"> </a><a name="6311" href="#6269" class="Bound">Δ</a><a name="6312"> </a><a name="6313" href="#6271" class="Bound">Γ</a><a name="6314" class="Symbol">}</a><a name="6315">               
                </a><a name="6347" class="Symbol">{</a><a name="6348" href="#6348" class="Bound">τ</a><a name="6349">     </a><a name="6354" class="Symbol">:</a><a name="6355"> </a><a name="6356" href="#3151" class="Bound">Subst</a><a name="6361"> </a><a name="6362" href="#6267" class="Bound">Θ</a><a name="6363"> </a><a name="6364" href="#6269" class="Bound">Δ</a><a name="6365" class="Symbol">}</a><a name="6366">
                </a><a name="6383" class="Symbol">{</a><a name="6384" href="#6384" class="Bound">A</a><a name="6385">     </a><a name="6390" class="Symbol">:</a><a name="6391"> </a><a name="6392" href="#3622" class="Bound">Ty</a><a name="6394"> </a><a name="6395" href="#6271" class="Bound">Γ</a><a name="6396" class="Symbol">}</a><a name="6397">
                </a><a name="6414" class="Symbol">{</a><a name="6415" href="#6415" class="Bound">a</a><a name="6416">     </a><a name="6421" class="Symbol">:</a><a name="6422"> </a><a name="6423" href="#3663" class="Bound">Ter</a><a name="6426"> </a><a name="6427" href="#6271" class="Bound">Γ</a><a name="6428"> </a><a name="6429" href="#6384" class="Bound">A</a><a name="6430" class="Symbol">}</a><a name="6431">
                </a><a name="6448" class="Symbol">→</a><a name="6449"> </a><a name="6450" class="Comment">---------------------------------------------------</a><a name="6501">
                </a><a name="6518" href="#4321" class="Bound">tApp</a><a name="6522"> </a><a name="6523" href="#6348" class="Bound">τ</a><a name="6524"> </a><a name="6525" class="Symbol">(</a><a name="6526" href="#4321" class="Bound">tApp</a><a name="6530"> </a><a name="6531" href="#6297" class="Bound">σ</a><a name="6532"> </a><a name="6533" href="#6415" class="Bound">a</a><a name="6534" class="Symbol">)</a><a name="6535">
                  </a><a name="6554" class="Function Operator">≡[</a><a name="6556"> </a><a name="6557" class="Function">ap</a><a name="6559"> </a><a name="6560" class="Symbol">(</a><a name="6561" href="#3663" class="Bound">Ter</a><a name="6564"> </a><a name="6565" href="#6267" class="Bound">Θ</a><a name="6566" class="Symbol">)</a><a name="6567"> </a><a name="6568" href="#5446" class="Bound">TAppEq</a><a name="6574"> </a><a name="6575" class="Function Operator">]≡</a><a name="6577">
                </a><a name="6594" href="#4321" class="Bound">tApp</a><a name="6598"> </a><a name="6599" class="Symbol">(</a><a name="6600" href="#6297" class="Bound">σ</a><a name="6601"> </a><a name="6602" class="Function Operator">∘</a><a name="6603"> </a><a name="6604" href="#6348" class="Bound">τ</a><a name="6605" class="Symbol">)</a><a name="6606"> </a><a name="6607" href="#6415" class="Bound">a</a><a name="6608">

    </a><a name="6614" href="#6614" class="Field">tAppAp</a><a name="6620">    </a><a name="6624" class="Symbol">:</a><a name="6625"> </a><a name="6626" class="Symbol">{</a><a name="6627" href="#6627" class="Bound">Δ</a><a name="6628"> </a><a name="6629" href="#6629" class="Bound">Γ</a><a name="6630">   </a><a name="6633" class="Symbol">:</a><a name="6634"> </a><a name="6635" href="#2981" class="Bound">Ctx</a><a name="6638" class="Symbol">}</a><a name="6639">
                </a><a name="6656" class="Symbol">{</a><a name="6657" href="#6657" class="Bound">σ</a><a name="6658">     </a><a name="6663" class="Symbol">:</a><a name="6664"> </a><a name="6665" href="#3151" class="Bound">Subst</a><a name="6670"> </a><a name="6671" href="#6627" class="Bound">Δ</a><a name="6672"> </a><a name="6673" href="#6629" class="Bound">Γ</a><a name="6674" class="Symbol">}</a><a name="6675">               
                </a><a name="6707" class="Symbol">{</a><a name="6708" href="#6708" class="Bound">τ</a><a name="6709">     </a><a name="6714" class="Symbol">:</a><a name="6715"> </a><a name="6716" href="#3151" class="Bound">Subst</a><a name="6721"> </a><a name="6722" href="#6627" class="Bound">Δ</a><a name="6723"> </a><a name="6724" href="#6629" class="Bound">Γ</a><a name="6725" class="Symbol">}</a><a name="6726">
                </a><a name="6743" class="Symbol">{</a><a name="6744" href="#6744" class="Bound">A</a><a name="6745">     </a><a name="6750" class="Symbol">:</a><a name="6751"> </a><a name="6752" href="#3622" class="Bound">Ty</a><a name="6754"> </a><a name="6755" href="#6629" class="Bound">Γ</a><a name="6756" class="Symbol">}</a><a name="6757">
                </a><a name="6774" class="Symbol">{</a><a name="6775" href="#6775" class="Bound">a</a><a name="6776">     </a><a name="6781" class="Symbol">:</a><a name="6782"> </a><a name="6783" href="#3663" class="Bound">Ter</a><a name="6786"> </a><a name="6787" href="#6629" class="Bound">Γ</a><a name="6788"> </a><a name="6789" href="#6744" class="Bound">A</a><a name="6790" class="Symbol">}</a><a name="6791">              
                </a><a name="6822" class="Symbol">(</a><a name="6823" href="#6823" class="Bound">p</a><a name="6824">     </a><a name="6829" class="Symbol">:</a><a name="6830"> </a><a name="6831" href="#6657" class="Bound">σ</a><a name="6832"> </a><a name="6833" class="Function Operator">≅</a><a name="6834"> </a><a name="6835" href="#6708" class="Bound">τ</a><a name="6836" class="Symbol">)</a><a name="6837">
                </a><a name="6854" class="Symbol">→</a><a name="6855"> </a><a name="6856" class="Comment">---------------------------------------------------</a><a name="6907">
                </a><a name="6924" href="#4321" class="Bound">tApp</a><a name="6928"> </a><a name="6929" href="#6657" class="Bound">σ</a><a name="6930"> </a><a name="6931" href="#6775" class="Bound">a</a><a name="6932">
                  </a><a name="6951" class="Function Operator">≡[</a><a name="6953"> </a><a name="6954" class="Function">ap</a><a name="6956"> </a><a name="6957" class="Symbol">(</a><a name="6958" href="#3663" class="Bound">Ter</a><a name="6961"> </a><a name="6962" href="#6627" class="Bound">Δ</a><a name="6963" class="Symbol">)</a><a name="6964"> </a><a name="6965" class="Symbol">(</a><a name="6966" href="#5716" class="Bound">TAppAp</a><a name="6972"> </a><a name="6973" href="#6823" class="Bound">p</a><a name="6974" class="Symbol">)</a><a name="6975"> </a><a name="6976" class="Function Operator">]≡</a><a name="6978">
                </a><a name="6995" href="#4321" class="Bound">tApp</a><a name="6999"> </a><a name="7000" href="#6708" class="Bound">τ</a><a name="7001"> </a><a name="7002" href="#6775" class="Bound">a</a></code></pre>
<p>The definition of a <code>CwF</code> is just a list of properties the previously described categorical structure must follow. These properties simply inforce a minimal description of a dependent type theory on the syntax we just described.</p>
<p>A <code>CwF</code> requires its base category, <code>C</code>, to have a terminal object here denoted by <code>[]</code>. Translated to type theory, this just means that the type system must have a unique empty context.</p>
<pre class="Agda"><code><a name="7432">    </a><a name="7451" href="#7451" class="Field">[]</a><a name="7453">        </a><a name="7461" class="Symbol">:</a><a name="7462"> </a><a name="7463" class="Record">Terminal</a></code></pre>
<p>Next, given an arbitrary context <code>Γ</code> and some type <code>A</code> well formed in <code>Γ</code>, there must be another context that extends <code>Γ</code> with a new variable of type <code>A</code>. We will write this extended context as <code>ctxExt Γ A</code>.</p>
<pre class="Agda"><code><a name="7691">    </a><a name="7710" href="#7710" class="Field">ctxExt</a><a name="7716">    </a><a name="7720" class="Symbol">:</a><a name="7721"> </a><a name="7722" class="Symbol">(</a><a name="7723" href="#7723" class="Bound">Γ</a><a name="7724"> </a><a name="7725" class="Symbol">:</a><a name="7726"> </a><a name="7727" href="#2981" class="Bound">Ctx</a><a name="7730" class="Symbol">)</a><a name="7731">
                </a><a name="7748" class="Symbol">(</a><a name="7749" href="#7749" class="Bound">A</a><a name="7750"> </a><a name="7751" class="Symbol">:</a><a name="7752"> </a><a name="7753" href="#3622" class="Bound">Ty</a><a name="7755"> </a><a name="7756" href="#7723" class="Bound">Γ</a><a name="7757" class="Symbol">)</a><a name="7758">
                </a><a name="7775" class="Symbol">→</a><a name="7776"> </a><a name="7777" class="Comment">---------------------------------------------------</a><a name="7828">
                </a><a name="7845" href="#2981" class="Bound">Ctx</a></code></pre>
<p>Now that we can extend contexts, we require our type theory to also permit weakening. Thus, we define <code>p</code> as the weakining substitution.</p>
<pre class="Agda"><code><a name="7997">    </a><a name="8029" href="#8029" class="Field">p</a><a name="8030">         </a><a name="8039" class="Symbol">:</a><a name="8040"> </a><a name="8041" class="Symbol">{</a><a name="8042" href="#8042" class="Bound">Γ</a><a name="8043"> </a><a name="8044" class="Symbol">:</a><a name="8045"> </a><a name="8046" href="#2981" class="Bound">Ctx</a><a name="8049" class="Symbol">}</a><a name="8050">
                </a><a name="8067" class="Symbol">{</a><a name="8068" href="#8068" class="Bound">A</a><a name="8069"> </a><a name="8070" class="Symbol">:</a><a name="8071"> </a><a name="8072" href="#3622" class="Bound">Ty</a><a name="8074"> </a><a name="8075" href="#8042" class="Bound">Γ</a><a name="8076" class="Symbol">}</a><a name="8077">
                </a><a name="8094" class="Symbol">→</a><a name="8095"> </a><a name="8096" class="Comment">---------------------------------------------------</a><a name="8147">
                </a><a name="8164" href="#3151" class="Bound">Subst</a><a name="8169"> </a><a name="8170" class="Symbol">(</a><a name="8171" href="#7710" class="Bound">ctxExt</a><a name="8177"> </a><a name="8178" href="#8042" class="Bound">Γ</a><a name="8179"> </a><a name="8180" href="#8068" class="Bound">A</a><a name="8181" class="Symbol">)</a><a name="8182"> </a><a name="8183" href="#8042" class="Bound">Γ</a></code></pre>
<p>When extending contexts, we also need a way to refer to the new variable that is added to the context; the term <code>q</code> represents this new term.</p>
<pre class="Agda"><code><a name="8338">    </a><a name="8357" href="#8357" class="Field">q</a><a name="8358">         </a><a name="8367" class="Symbol">:</a><a name="8368"> </a><a name="8369" class="Symbol">{</a><a name="8370" href="#8370" class="Bound">Γ</a><a name="8371"> </a><a name="8372" class="Symbol">:</a><a name="8373"> </a><a name="8374" href="#2981" class="Bound">Ctx</a><a name="8377" class="Symbol">}</a><a name="8378">
                </a><a name="8395" class="Symbol">{</a><a name="8396" href="#8396" class="Bound">A</a><a name="8397"> </a><a name="8398" class="Symbol">:</a><a name="8399"> </a><a name="8400" href="#3622" class="Bound">Ty</a><a name="8402"> </a><a name="8403" href="#8370" class="Bound">Γ</a><a name="8404" class="Symbol">}</a><a name="8405">
                </a><a name="8422" class="Symbol">→</a><a name="8423"> </a><a name="8424" class="Comment">---------------------------------------------------</a><a name="8475">
                </a><a name="8492" href="#3663" class="Bound">Ter</a><a name="8495"> </a><a name="8496" class="Symbol">(</a><a name="8497" href="#7710" class="Bound">ctxExt</a><a name="8503"> </a><a name="8504" href="#8370" class="Bound">Γ</a><a name="8505"> </a><a name="8506" href="#8396" class="Bound">A</a><a name="8507" class="Symbol">)</a><a name="8508"> </a><a name="8509" class="Symbol">(</a><a name="8510" href="#4166" class="Bound">TApp</a><a name="8514"> </a><a name="8515" class="Symbol">(</a><a name="8516" href="#8029" class="Bound">p</a><a name="8517"> </a><a name="8518" class="Symbol">{</a><a name="8519" href="#8370" class="Bound">Γ</a><a name="8520" class="Symbol">}</a><a name="8521"> </a><a name="8522" class="Symbol">{</a><a name="8523" href="#8396" class="Bound">A</a><a name="8524" class="Symbol">})</a><a name="8526"> </a><a name="8527" href="#8396" class="Bound">A</a><a name="8528" class="Symbol">)</a></code></pre>
<p>Lastly, for a substitution <code>σ</code> that takes types and terms from context <code>Γ</code> to <code>Δ</code>, a type <code>A</code> well formed in <code>Γ</code>, and some term <code>a</code> in <code>Δ</code> of type <code>TApp σ A</code> (i.e. type <code>A</code> with the substituion <code>σ</code> applied to it), we can define another substitution that takes in types and terms from <code>Γ</code> extended with a variable of type <code>A</code> to types and terms in the context <code>Δ</code>. While there are a number of moving parts defining the substitution, the idea is quite intuitive; if <code>σ</code> is way way to get from context <code>Γ</code> to <code>Δ</code>, and we know how to make a term <code>a</code> of type <code>A</code> in <code>Δ</code>, we can also get from <code>ctxExt Γ A</code> to <code>Δ</code> by using the original substitution <code>σ</code> for everything in <code>Γ</code>, and whenever the new variable of type <code>A</code> shows up, replacing it with the term <code>a</code> we provided. Note that the previous sentece ignores the action of the substitution <code>σ</code> on <code>A</code> for the sake of clarity.</p>
<pre class="Agda"><code><a name="9413">    </a><a name="9432" href="#9432" class="Field">uSubst</a><a name="9438">    </a><a name="9442" class="Symbol">:</a><a name="9443"> </a><a name="9444" class="Symbol">{</a><a name="9445" href="#9445" class="Bound">Δ</a><a name="9446"> </a><a name="9447" href="#9447" class="Bound">Γ</a><a name="9448"> </a><a name="9449" class="Symbol">:</a><a name="9450"> </a><a name="9451" href="#2981" class="Bound">Ctx</a><a name="9454" class="Symbol">}</a><a name="9455">
                </a><a name="9472" class="Symbol">(</a><a name="9473" href="#9473" class="Bound">σ</a><a name="9474">   </a><a name="9477" class="Symbol">:</a><a name="9478"> </a><a name="9479" href="#3151" class="Bound">Subst</a><a name="9484"> </a><a name="9485" href="#9445" class="Bound">Δ</a><a name="9486"> </a><a name="9487" href="#9447" class="Bound">Γ</a><a name="9488" class="Symbol">)</a><a name="9489">
                </a><a name="9506" class="Symbol">{</a><a name="9507" href="#9507" class="Bound">A</a><a name="9508">   </a><a name="9511" class="Symbol">:</a><a name="9512"> </a><a name="9513" href="#3622" class="Bound">Ty</a><a name="9515"> </a><a name="9516" href="#9447" class="Bound">Γ</a><a name="9517" class="Symbol">}</a><a name="9518">
                </a><a name="9535" class="Symbol">(</a><a name="9536" href="#9536" class="Bound">a</a><a name="9537">   </a><a name="9540" class="Symbol">:</a><a name="9541"> </a><a name="9542" href="#3663" class="Bound">Ter</a><a name="9545"> </a><a name="9546" href="#9445" class="Bound">Δ</a><a name="9547"> </a><a name="9548" class="Symbol">(</a><a name="9549" href="#4166" class="Bound">TApp</a><a name="9553"> </a><a name="9554" href="#9473" class="Bound">σ</a><a name="9555"> </a><a name="9556" href="#9507" class="Bound">A</a><a name="9557" class="Symbol">))</a><a name="9559">
                </a><a name="9576" class="Symbol">→</a><a name="9577"> </a><a name="9578" class="Comment">---------------------------------------------------</a><a name="9629">
                </a><a name="9646" href="#3151" class="Bound">Subst</a><a name="9651"> </a><a name="9652" href="#9445" class="Bound">Δ</a><a name="9653"> </a><a name="9654" class="Symbol">(</a><a name="9655" href="#7710" class="Bound">ctxExt</a><a name="9661"> </a><a name="9662" href="#9447" class="Bound">Γ</a><a name="9663"> </a><a name="9664" href="#9507" class="Bound">A</a><a name="9665" class="Symbol">)</a></code></pre>
<p>We require the following equalities involving <code>uSubst</code> to hold, which just .enforce that the type theoretic interpretations are consistent with the category theory.</p>
<p>If we use the <code>uSubst</code> rule to strengthen a substitution and immedietly weaken it, we end up with the same substitution we began with.</p>
<pre class="Agda"><code><a name="9979">    </a><a name="9998" href="#9998" class="Field">uEq₁</a><a name="10002">      </a><a name="10008" class="Symbol">:</a><a name="10009"> </a><a name="10010" class="Symbol">{</a><a name="10011" href="#10011" class="Bound">Δ</a><a name="10012"> </a><a name="10013" href="#10013" class="Bound">Γ</a><a name="10014"> </a><a name="10015" class="Symbol">:</a><a name="10016"> </a><a name="10017" href="#2981" class="Bound">Ctx</a><a name="10020" class="Symbol">}</a><a name="10021">
                </a><a name="10038" class="Symbol">(</a><a name="10039" href="#10039" class="Bound">σ</a><a name="10040">   </a><a name="10043" class="Symbol">:</a><a name="10044"> </a><a name="10045" href="#3151" class="Bound">Subst</a><a name="10050"> </a><a name="10051" href="#10011" class="Bound">Δ</a><a name="10052"> </a><a name="10053" href="#10013" class="Bound">Γ</a><a name="10054" class="Symbol">)</a><a name="10055">
                </a><a name="10072" class="Symbol">{</a><a name="10073" href="#10073" class="Bound">A</a><a name="10074">   </a><a name="10077" class="Symbol">:</a><a name="10078"> </a><a name="10079" href="#3622" class="Bound">Ty</a><a name="10081"> </a><a name="10082" href="#10013" class="Bound">Γ</a><a name="10083" class="Symbol">}</a><a name="10084">
                </a><a name="10101" class="Symbol">(</a><a name="10102" href="#10102" class="Bound">a</a><a name="10103">   </a><a name="10106" class="Symbol">:</a><a name="10107"> </a><a name="10108" href="#3663" class="Bound">Ter</a><a name="10111"> </a><a name="10112" href="#10011" class="Bound">Δ</a><a name="10113"> </a><a name="10114" class="Symbol">(</a><a name="10115" href="#4166" class="Bound">TApp</a><a name="10119"> </a><a name="10120" href="#10039" class="Bound">σ</a><a name="10121"> </a><a name="10122" href="#10073" class="Bound">A</a><a name="10123" class="Symbol">))</a><a name="10125">
                </a><a name="10142" class="Symbol">→</a><a name="10143"> </a><a name="10144" class="Comment">---------------------------------------------------</a><a name="10195">
                </a><a name="10212" href="#8029" class="Bound">p</a><a name="10213"> </a><a name="10214" class="Function Operator">∘</a><a name="10215"> </a><a name="10216" class="Symbol">(</a><a name="10217" href="#9432" class="Bound">uSubst</a><a name="10223"> </a><a name="10224" href="#10039" class="Bound">σ</a><a name="10225"> </a><a name="10226" href="#10102" class="Bound">a</a><a name="10227" class="Symbol">)</a><a name="10228"> </a><a name="10229" class="Function Operator">≅</a><a name="10230"> </a><a name="10231" href="#10039" class="Bound">σ</a></code></pre>
<p>If we use <code>uSubst</code> to strengthen the weakinging substitution by providing the variable of the extended context, we end up with the trivial substitution from the extended context to itself.</p>
<pre class="Agda"><code><a name="10433">    </a><a name="10452" href="#10452" class="Field">uEq₂</a><a name="10456">      </a><a name="10462" class="Symbol">:</a><a name="10463"> </a><a name="10464" class="Symbol">{</a><a name="10465" href="#10465" class="Bound">Γ</a><a name="10466"> </a><a name="10467" class="Symbol">:</a><a name="10468"> </a><a name="10469" href="#2981" class="Bound">Ctx</a><a name="10472" class="Symbol">}</a><a name="10473">
                </a><a name="10490" class="Symbol">{</a><a name="10491" href="#10491" class="Bound">A</a><a name="10492"> </a><a name="10493" class="Symbol">:</a><a name="10494"> </a><a name="10495" href="#3622" class="Bound">Ty</a><a name="10497"> </a><a name="10498" href="#10465" class="Bound">Γ</a><a name="10499" class="Symbol">}</a><a name="10500">
                </a><a name="10517" class="Symbol">→</a><a name="10518"> </a><a name="10519" class="Comment">---------------------------------------------------</a><a name="10570">
                </a><a name="10587" href="#9432" class="Bound">uSubst</a><a name="10593"> </a><a name="10594" class="Symbol">(</a><a name="10595" href="#8029" class="Bound">p</a><a name="10596"> </a><a name="10597" class="Symbol">{</a><a name="10598" href="#10465" class="Bound">Γ</a><a name="10599" class="Symbol">}</a><a name="10600"> </a><a name="10601" class="Symbol">{</a><a name="10602" href="#10491" class="Bound">A</a><a name="10603" class="Symbol">})</a><a name="10605"> </a><a name="10606" class="Symbol">(</a><a name="10607" href="#8357" class="Bound">q</a><a name="10608"> </a><a name="10609" class="Symbol">{</a><a name="10610" href="#10465" class="Bound">Γ</a><a name="10611" class="Symbol">}</a><a name="10612"> </a><a name="10613" class="Symbol">{</a><a name="10614" href="#10491" class="Bound">A</a><a name="10615" class="Symbol">})</a><a name="10617"> </a><a name="10618" class="Function Operator">≅</a><a name="10619"> </a><a name="10620" href="#3169" class="Bound">Id</a></code></pre>
<p>If we do another substitution <code>τ</code> after <code>uSubst σ a</code>, it is the same as the substitution given by applying <code>uSubst</code> to the composed substitution <code>σ ∘ τ</code> and the term given by applying <code>τ</code> to <code>a</code> .</p>
<pre class="Agda"><code><a name="10832">    </a><a name="10865" href="#10865" class="Field">uEq₃</a><a name="10869">      </a><a name="10875" class="Symbol">:</a><a name="10876"> </a><a name="10877" class="Symbol">{</a><a name="10878" href="#10878" class="Bound">Δ</a><a name="10879"> </a><a name="10880" href="#10880" class="Bound">Γ</a><a name="10881"> </a><a name="10882" href="#10882" class="Bound">Θ</a><a name="10883"> </a><a name="10884" class="Symbol">:</a><a name="10885"> </a><a name="10886" href="#2981" class="Bound">Ctx</a><a name="10889" class="Symbol">}</a><a name="10890">
                </a><a name="10907" class="Symbol">(</a><a name="10908" href="#10908" class="Bound">σ</a><a name="10909">     </a><a name="10914" class="Symbol">:</a><a name="10915"> </a><a name="10916" href="#3151" class="Bound">Subst</a><a name="10921"> </a><a name="10922" href="#10878" class="Bound">Δ</a><a name="10923"> </a><a name="10924" href="#10880" class="Bound">Γ</a><a name="10925" class="Symbol">)</a><a name="10926">
                </a><a name="10943" class="Symbol">{</a><a name="10944" href="#10944" class="Bound">A</a><a name="10945">     </a><a name="10950" class="Symbol">:</a><a name="10951"> </a><a name="10952" href="#3622" class="Bound">Ty</a><a name="10954"> </a><a name="10955" href="#10880" class="Bound">Γ</a><a name="10956" class="Symbol">}</a><a name="10957">
                </a><a name="10974" class="Symbol">(</a><a name="10975" href="#10975" class="Bound">a</a><a name="10976">     </a><a name="10981" class="Symbol">:</a><a name="10982"> </a><a name="10983" href="#3663" class="Bound">Ter</a><a name="10986"> </a><a name="10987" href="#10878" class="Bound">Δ</a><a name="10988"> </a><a name="10989" class="Symbol">(</a><a name="10990" href="#4166" class="Bound">TApp</a><a name="10994"> </a><a name="10995" href="#10908" class="Bound">σ</a><a name="10996"> </a><a name="10997" href="#10944" class="Bound">A</a><a name="10998" class="Symbol">))</a><a name="11000">
                </a><a name="11017" class="Symbol">(</a><a name="11018" href="#11018" class="Bound">τ</a><a name="11019">     </a><a name="11024" class="Symbol">:</a><a name="11025"> </a><a name="11026" href="#3151" class="Bound">Subst</a><a name="11031"> </a><a name="11032" href="#10882" class="Bound">Θ</a><a name="11033"> </a><a name="11034" href="#10878" class="Bound">Δ</a><a name="11035" class="Symbol">)</a><a name="11036">
                </a><a name="11053" class="Symbol">→</a><a name="11054"> </a><a name="11055" class="Comment">---------------------------------------------------</a><a name="11106">
                </a><a name="11123" class="Symbol">(</a><a name="11124" href="#9432" class="Bound">uSubst</a><a name="11130"> </a><a name="11131" href="#10908" class="Bound">σ</a><a name="11132"> </a><a name="11133" href="#10975" class="Bound">a</a><a name="11134" class="Symbol">)</a><a name="11135"> </a><a name="11136" class="Function Operator">∘</a><a name="11137"> </a><a name="11138" href="#11018" class="Bound">τ</a><a name="11139">
                  </a><a name="11158" class="Function Operator">≅</a><a name="11159">
                </a><a name="11176" href="#9432" class="Bound">uSubst</a><a name="11182"> </a><a name="11183" class="Symbol">(</a><a name="11184" href="#10908" class="Bound">σ</a><a name="11185"> </a><a name="11186" class="Function Operator">∘</a><a name="11187"> </a><a name="11188" href="#11018" class="Bound">τ</a><a name="11189" class="Symbol">)</a><a name="11190"> </a><a name="11191" class="Symbol">(</a><a name="11192" class="Function">coe</a><a name="11195"> </a><a name="11196" class="Symbol">(</a><a name="11197" class="Function">ap</a><a name="11199"> </a><a name="11200" class="Symbol">(</a><a name="11201" href="#3663" class="Bound">Ter</a><a name="11204"> </a><a name="11205" href="#10882" class="Bound">Θ</a><a name="11206" class="Symbol">)</a><a name="11207"> </a><a name="11208" href="#5446" class="Bound">TAppEq</a><a name="11214" class="Symbol">)</a><a name="11215"> </a><a name="11216" class="Symbol">(</a><a name="11217" href="#4321" class="Bound">tApp</a><a name="11221"> </a><a name="11222" href="#11018" class="Bound">τ</a><a name="11223"> </a><a name="11224" href="#10975" class="Bound">a</a><a name="11225" class="Symbol">))</a></code></pre>
<p>Lastly, when we apply <code>uSubst σ a</code> to the variable of the extended context, <code>q</code>, we get the term provided to <code>uSubst</code>, namely <code>a</code>. This is precisely what we expect based on the previous the explanation for what <code>uSubst</code> means. Unfortunately, Agda’s intensional type theory requires a lot of manual equality manipulation for this statement to type check.</p>
<pre class="Agda"><code><a name="11593">    </a><a name="11612" href="#11612" class="Field">uEq₄</a><a name="11616">      </a><a name="11622" class="Symbol">:</a><a name="11623"> </a><a name="11624" class="Symbol">{</a><a name="11625" href="#11625" class="Bound">Δ</a><a name="11626"> </a><a name="11627" href="#11627" class="Bound">Γ</a><a name="11628"> </a><a name="11629" class="Symbol">:</a><a name="11630"> </a><a name="11631" href="#2981" class="Bound">Ctx</a><a name="11634" class="Symbol">}</a><a name="11635">
                </a><a name="11652" class="Symbol">(</a><a name="11653" href="#11653" class="Bound">σ</a><a name="11654">   </a><a name="11657" class="Symbol">:</a><a name="11658"> </a><a name="11659" href="#3151" class="Bound">Subst</a><a name="11664"> </a><a name="11665" href="#11625" class="Bound">Δ</a><a name="11666"> </a><a name="11667" href="#11627" class="Bound">Γ</a><a name="11668" class="Symbol">)</a><a name="11669">
                </a><a name="11686" class="Symbol">{</a><a name="11687" href="#11687" class="Bound">A</a><a name="11688">   </a><a name="11691" class="Symbol">:</a><a name="11692"> </a><a name="11693" href="#3622" class="Bound">Ty</a><a name="11695"> </a><a name="11696" href="#11627" class="Bound">Γ</a><a name="11697" class="Symbol">}</a><a name="11698">
                </a><a name="11715" class="Symbol">(</a><a name="11716" href="#11716" class="Bound">a</a><a name="11717">   </a><a name="11720" class="Symbol">:</a><a name="11721"> </a><a name="11722" href="#3663" class="Bound">Ter</a><a name="11725"> </a><a name="11726" href="#11625" class="Bound">Δ</a><a name="11727"> </a><a name="11728" class="Symbol">(</a><a name="11729" href="#4166" class="Bound">TApp</a><a name="11733"> </a><a name="11734" href="#11653" class="Bound">σ</a><a name="11735"> </a><a name="11736" href="#11687" class="Bound">A</a><a name="11737" class="Symbol">))</a><a name="11739">
                </a><a name="11756" class="Symbol">→</a><a name="11757"> </a><a name="11758" class="Comment">---------------------------------------------------</a><a name="11809">
                </a><a name="11826" href="#4321" class="Bound">tApp</a><a name="11830"> </a><a name="11831" class="Symbol">(</a><a name="11832" href="#9432" class="Bound">uSubst</a><a name="11838"> </a><a name="11839" href="#11653" class="Bound">σ</a><a name="11840"> </a><a name="11841" href="#11716" class="Bound">a</a><a name="11842" class="Symbol">)</a><a name="11843"> </a><a name="11844" href="#8357" class="Bound">q</a><a name="11845">
                  </a><a name="11864" class="Function Operator">≡[</a><a name="11866"> </a><a name="11867" class="Function">ap</a><a name="11869"> </a><a name="11870" class="Symbol">(</a><a name="11871" href="#3663" class="Bound">Ter</a><a name="11874"> </a><a name="11875" href="#11625" class="Bound">Δ</a><a name="11876" class="Symbol">)</a><a name="11877"> </a><a name="11878" class="Symbol">(</a><a name="11879" class="Function">trans</a><a name="11884"> </a><a name="11885" href="#5446" class="Bound">TAppEq</a><a name="11891"> </a><a name="11892" class="Symbol">(</a><a name="11893" href="#5716" class="Bound">TAppAp</a><a name="11899"> </a><a name="11900" class="Symbol">(</a><a name="11901" href="#9998" class="Bound">uEq₁</a><a name="11905"> </a><a name="11906" href="#11653" class="Bound">σ</a><a name="11907"> </a><a name="11908" href="#11716" class="Bound">a</a><a name="11909" class="Symbol">)))</a><a name="11912"> </a><a name="11913" class="Function Operator">]≡</a><a name="11915">
                </a><a name="11932" href="#11716" class="Bound">a</a></code></pre>
<p>Note that, from the base definition of a <code>CwF</code>, the type theory only includes a notion of dependency and substitutions. This defnition can be extend with further restrictions that allow for it to model richer type systems, including Π-types, Σ-types, equality types, universes, and much more.</p>
<p>If you want to look at the definition of <code>CwF</code> without all of the intermittent text, view it in my GitHub <a href="https://github.com/mweav/Agda/blob/master/CwF.agda">here</a>!</p>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><a href="https://github.com/copumpkin/categories">Dan Peebles, James Deikun, Andrea Vezzosi, James Cook, and other contributors. Categories library.,</a><a href="#fnref1">↩</a></p></li>
<li id="fn2"><p><a href="http://www.cse.chalmers.se/~peterd/papers/InternalTT.pdf">Peter Dybjer. “Internal type theory.” 1995.</a><a href="#fnref2">↩</a></p></li>
<li id="fn3"><p><a href="http://bora.uib.no/bitstream/handle/1956/10215/7.pdf?sequence=4&amp;isAllowed=y">Mark Bezem, Thierry Coquand, and Simon Huber. “A model of type theory in cubical sets.” 2013.</a><a href="#fnref3">↩</a></p></li>
<li id="fn4"><p><a href="http://publications.lib.chalmers.se/records/fulltext/230735/local_230735.pdf">Jean-Philippe Bernardy, Thierry Coquand, and Guilhem Moulin. “A presheaf model of parametric type theory.” 2015.</a><a href="#fnref4">↩</a></p></li>
<li id="fn5"><p><a href="https://www.repository.cam.ac.uk/bitstream/handle/1810/247863/Pitts_et_al-2015-Electronic_Notes_in_Theoretical_Computer_Science.pdf?sequence=1">Andrew Pitts, Justus Matthiesen, and Jasper Derikx. “A dependent type theory with abstractable names.” 2015.</a><a href="#fnref5">↩</a></p></li>
</ol>
</div>

<div id="disqus_thread"></div>
<script>
/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = 'https://highertypes.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
        </div>
        <div id="footer">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
    </body>
</html>
